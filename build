#!/bin/sh
#Dependencies: Stopify Racketscript (Racks) NPM Node
RACKSOUT='js-build'
STOPDIR="node_modules/.bin/stopify"
STOPOUT="modules/$1.js"

echo "Building $1 to $RACKSOUT/$STOPOUT"

#run racks
racks -t stopify -d $RACKSOUT $1

cd js-build

#run rollup with babel
rollup --input $STOPOUT -o $STOPOUT -f cjs --config rollup.config.js

#use stopify
$STOPDIR --require-runtime $STOPOUT $STOPOUT

node $STOPOUT

cd ..